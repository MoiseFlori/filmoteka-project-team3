let e=[];async function t(){return 0===e.length&&await async function(){try{const t=await fetch("https://api.themoviedb.org/3/genre/movie/list?api_key=21161239b69d8dd6ebeec5ac6086d760&language=en-US"),n=await t.json();return n.genres&&(e=n.genres),e}catch(e){return console.error("Eroare la încărcarea genurilor:",e),[]}}(),e}const n=document.querySelector(".loader");function o(){n.classList.add("show"),setTimeout((()=>{n.classList.remove("show")}),1e3)}document.getElementById("search-form").addEventListener("submit",(()=>{o()}));const r=document.querySelector('[data-index="1"]'),a=document.querySelector('[data-index="2"]'),i=document.querySelector('[data-index="3"]'),s=document.querySelector('[data-index="4"]'),c=document.querySelector('[data-index="5"]'),l=document.querySelector(".first-button"),d=document.querySelector(".last-button"),u=document.querySelector(".pagination-container"),m=document.querySelector(".arrow-right"),v=document.querySelector(".arrow-left"),y=document.querySelector("#previous"),g=document.querySelector("#after");let p=1,f=20;function h(e){f=Math.min(e||20,20),u.style.display="flex";const t=[r,a,i,s,c];t.forEach((e=>e.hidden=!0));for(let e=0;e<Math.min(f,5);e++)t[e].hidden=!1,t[e].textContent=e+1,t[e].classList.toggle("pagination--current",e+1===p);if(d.textContent=f,l.hidden=p<=3||f<=5,y.hidden=p<=3||f<=5,d.hidden=p>=f-2||f<=5,g.hidden=p>=f-2||f<=5,v.hidden=p<=1,m.hidden=p>=f,p>3&&f>5){let e=p-2;e+4>f&&(e=f-4),t.forEach(((t,n)=>{t.hidden||(t.textContent=e+n,t.classList.toggle("pagination--current",e+n===p))}))}}async function E(e=p){console.log("Fetching popular movies for page:",e);const n=`https://api.themoviedb.org/3/movie/popular?api_key=21161239b69d8dd6ebeec5ac6086d760&language=en-US&page=${e}`;try{const e=await fetch(n),o=await e.json();if(!o.results||0===o.results.length)return console.error("No popular movies found:",o),{results:[],total_pages:0};const r=await t(),a=o.results.map((e=>({...e,genre_names:e.genre_ids.map((e=>r.find((t=>t.id===e))?.name||"Unknown"))})));return{results:a,total_pages:Math.min(o.total_pages,20)}}catch(e){return console.error("Error fetching popular movies:",e),{results:[],total_pages:0}}}async function b(e,n=1){const o=`https://api.themoviedb.org/3/search/movie?${new URLSearchParams({api_key:"21161239b69d8dd6ebeec5ac6086d760",query:e,page:n,language:"en-US",include_adult:!1})}`;try{const e=await fetch(o),n=await e.json();if(!n||!n.results)return{results:[],total_pages:0};const r=await t(),a=n.results.map((e=>({...e,genre_names:e.genre_ids?.map((e=>r.find((t=>t.id===e))?.name||"Unknown"))||[]})));return{results:a,total_pages:Math.min(n.total_pages,20)}}catch(e){return console.error("Error fetching movies:",e),{results:[],total_pages:0}}}async function w(e){const t=`https://api.themoviedb.org/3/movie/${e}?api_key=21161239b69d8dd6ebeec5ac6086d760&language=en-US`;try{const e=await fetch(t);if(!e.ok)throw new Error("Failed to fetch movie details");return await e.json()}catch(e){throw console.error("Error fetching movie details:",e),e}}async function _(e){try{const t=await fetch(`https://api.themoviedb.org/3/movie/${e}/videos?api_key=21161239b69d8dd6ebeec5ac6086d760`),n=(await t.json()).results.find((e=>"Trailer"===e.type&&"YouTube"===e.site));return n?`https://www.youtube.com/embed/${n.key}`:null}catch(e){return console.error("Error fetching trailer URL:",e),null}}u.addEventListener("click",(async function(e){const t=e.target;if("BUTTON"===t.tagName){t.blur();const e=p;t.classList.contains("pagination-button")&&t.dataset.index?p=Number(t.textContent):t.classList.contains("arrow-right")&&p<f?p+=1:t.classList.contains("arrow-left")&&p>1?p-=1:t.classList.contains("first-button")?p=1:t.classList.contains("last-button")&&(p=f),e!==p&&(window.scrollTo({top:0,behavior:"smooth"}),Z?await P(Z,p):await V(p))}o()})),window.addEventListener("resize",(function(){let e=20;return(window.innerWidth>=1024||window.innerWidth>=768&&window.innerWidth<1024||window.innerWidth<768)&&(e=20),e}));document.getElementById("search-form"),document.querySelector(".form-input");const L=document.querySelector(".movies");document.querySelector(".header"),document.querySelector(".menu__link-home"),document.querySelector(".menu__link-library"),document.querySelector(".modal__backdrop"),document.getElementById("modal"),document.querySelector(".warning-notification"),document.querySelector(".pagination-container");function k(){const e=document.getElementById("trailer-modal-container"),t=document.getElementById("trailer-backdrop"),n=document.getElementById("trailer-content");function r(){n.innerHTML="",e.classList.remove("open")}return t.addEventListener("click",r),document.addEventListener("keydown",(t=>{"Escape"===t.key&&e.classList.contains("open")&&r()})),function(t){n.innerHTML=`\n      <iframe \n        src="${t}" \n        frameborder="0" \n        allow="autoplay; encrypted-media" \n        allowfullscreen>\n      </iframe>`,e.classList.add("open"),o()}}function S(e){return JSON.parse(localStorage.getItem(e))||[]}function q(e,t){return S(e).some((e=>e.id===t))}async function T(e,n){let o=S(e);if(q(e,n.id))o=o.filter((e=>e.id!==n.id));else{const e=await t(),r={...n,genre_names:n.genre_ids?.map((t=>e.find((e=>e.id===t))?.name||"Unknown Genre"))||[]};o.push(r)}localStorage.setItem(e,JSON.stringify(o))}async function M(e){const n=document.querySelector(".library-list");if(n.innerHTML="",e&&0!==e.length)try{const o=await t(),r=e.map((e=>({...e,genre_names:Array.isArray(e.genre_ids)?e.genre_ids.map((e=>o.find((t=>t.id===e))?.name||"Unknown Genre")):[]})));let a="";r.forEach((e=>{a+=z(e)})),n.innerHTML=`<ul class="movies">${a}</ul>`,n.addEventListener("click",(e=>{const t=e.target.closest(".movie_list_item");if(!t)return;Q(t.dataset.movieId)}))}catch(e){console.error("Error loading genres for library movies:",e),n.innerHTML="<p>Error loading movies. Please try again later.</p>"}else n.innerHTML="<p>No movies found.</p>"}function x({onWatchedTabClick:e,onQueueTabClick:t}){const n=document.querySelector("#watched-btn"),r=document.querySelector("#queue-btn");n.addEventListener("click",(()=>{n.classList.add("library-btn-active"),r.classList.remove("library-btn-active"),e(),o()})),r.addEventListener("click",(()=>{r.classList.add("library-btn-active"),n.classList.remove("library-btn-active"),t(),o()}))}function I(){document.querySelector("#library-buttons").style.display="block",M(S("watched")),x({onWatchedTabClick:()=>{M(S("watched"))},onQueueTabClick:()=>{M(S("queue"))}})}const C=document.getElementById("library-btn"),B=document.getElementById("home-btn"),$=document.getElementById("search-form"),U=document.getElementById("library-buttons"),H=document.getElementById("watched-button"),N=document.getElementById("queue-button"),D=document.querySelector(".gallery"),A=document.querySelector("#library-gallery");let O="home";function j(){return"library"===O}function R(){function e(){B.classList.remove("active"),C.classList.remove("active")}function t(){O="home",$.style.display="block",U.style.display="none",D.style.display="block",A.style.display="none",e(),B.classList.add("active"),o()}B.addEventListener("click",t),C.addEventListener("click",(function(){O="library",$.style.display="none",U.style.display="flex",D.style.display="none",A.style.display="block",e(),C.classList.add("active"),H.classList.add("library-btn-active"),N.classList.remove("library-btn-active"),I(),o()})),t()}function W(e){H.textContent=q("watched",e.id)?"REMOVE FROM WATCHED":"ADD TO WATCHED",N.textContent=q("queue",e.id)?"REMOVE FROM QUEUE":"ADD TO QUEUE",H.onclick=()=>{T("watched",e),H.textContent=q("watched",e.id)?"REMOVE FROM WATCHED":"ADD TO WATCHED",j()&&(I(),F())},N.onclick=()=>{T("queue",e),N.textContent=q("queue",e.id)?"REMOVE FROM QUEUE":"ADD TO QUEUE",j()&&(I(),F())}}function F(){const e=document.createElement("p");e.textContent="Library updated!",e.className="update-message",document.querySelector("#library-gallery").prepend(e),setTimeout((()=>{e.remove()}),2e3)}async function Q(e){const t=document.querySelector(".modal-wrapper"),n=document.querySelector(".backdrop"),o=document.getElementById("poster-section"),r=document.getElementById("movie-title"),a=(document.getElementById("movie-votes"),document.getElementById("movie-popularity")),i=document.getElementById("original-title"),s=document.getElementById("movie-genre"),c=document.getElementById("movie-about"),l=document.getElementById("trailer-button"),d=k();if(e)try{!function(e){o.style.backgroundImage=`url('https://image.tmdb.org/t/p/w500/${e.poster_path||""}')`,r.textContent=e.title||"No Title";let t="movie__average--red";e.vote_average>=7?t="movie__average--green":e.vote_average>=5&&(t="movie__average--orange");const n=document.querySelector("#modal-movie-votes");n&&(n.innerHTML=`\n        <span class="vote-average ${t}">\n          ${e.vote_average?.toFixed(1)||"N/A"}\n        </span>\n        <span class="vote-separator">/</span>\n        <span class="vote-count">\n          ${e.vote_count||0}\n        </span>\n      `);a.textContent=e.popularity?.toFixed(1)||"N/A",i.textContent=e.original_title||"N/A",s.textContent=e.genres?.map((e=>e.name)).join(", ")||"Unknown",c.textContent=e.overview||"No description available.",l.onclick=()=>async function(e){try{const t=await _(e);t?d(t):alert("Trailer not available.")}catch(e){console.error("Error fetching trailer:",e)}}(e.id),W(e)}(await w(e)),document.body.classList.add("modal-open"),t.classList.add("open"),n.addEventListener("click",u),document.addEventListener("keydown",m),t.addEventListener("click",v)}catch(e){console.error("Error fetching movie details:",e)}else console.error("No movie ID provided!");function u(){document.body.classList.remove("modal-open"),t.classList.remove("open"),n.removeEventListener("click",u),document.removeEventListener("keydown",m),t.removeEventListener("click",v)}function m(e){"Escape"===e.key&&t.classList.contains("open")&&u()}function v(e){document.getElementById("movie-details").contains(e.target)||u()}}function z(e){let t="movie__average--red";e.vote_average>=7?t="movie__average--green":e.vote_average>=5&&(t="movie__average--orange");const n=e.poster_path?`https://image.tmdb.org/t/p/w500${e.poster_path}`:"./images/no-image-available.jpg",o=e.poster_path?`${e.title||""} movie poster`:"No poster available",r=e.genre_names||[];let a=r.slice(0,2);r.length>2&&a.push("Other");const i=r.length>0?a.join(", "):"",s=void 0!==e.vote_average?e.vote_average.toFixed(1):"",c=e.release_date?new Date(e.release_date).getFullYear():"";return`\n    <li class="movie_list_item" data-movie-id="${e.id||""}">\n      <div class="movie__cover-inner">\n        <img \n          class="movie__cover" \n          src="${n}" \n          alt="${o}" \n        />\n      </div>\n      <div class="movie__cover--darkened"></div>\n      <div class="movie-info">\n        ${e.title?`<h3 class="movie-title">${e.title}</h3>`:""}\n        ${i||c?`<p class="movie-date">${[i,c].filter(Boolean).join(" | ")}</p>`:""}\n        ${s?`<div class="movie__average ${t}">${s}</div>`:""}\n      </div>\n    </li>\n  `}function G(){const e=window.innerWidth;return e>=1024?18:e>=768?16:20}async function P(e,t){try{const{results:n,total_pages:o}=await b(e,t);if(!n||0===n.length)return L.innerHTML="<p>No movies found.</p>",void h(0);const r=G(),a=n.slice(0,r).map(z).join("");L.innerHTML=a,h(o)}catch(e){console.error("Error displaying searched movies:",e),L.innerHTML="<p>Error loading movies.</p>",h(0)}}async function V(e=1){console.log("Rendering movies for page:",e);try{const{results:t,total_pages:n}=await E(e);if(!t||0===t.length)return console.warn("No movies found"),L.innerHTML="<p>No movies found.</p>",void h(0);console.log("Movies fetched:",t.length);const r=G(),a=t.slice(0,r).map(z).join("");L?(L.innerHTML=a,h(n),L.addEventListener("click",(e=>{const t=e.target.closest(".movie_list_item");if(!t)return;const n=t.dataset.movieId;n?(console.log("Clicked movie ID:",n),Q(n),o()):console.error("Movie ID not found in clicked item")}))):console.error("Gallery element not found")}catch(e){console.error("Error displaying movies:",e),L&&(L.innerHTML="<p>Error loading movies.</p>"),h(0)}}async function J(e,n){const o=document.querySelector(".movies"),r=document.querySelector("#search-error");try{console.log("Apelare la funcția renderSearchedMovies...");const a=(await b(e,n))?.results||[];if(!Array.isArray(a)||0===a.length)return console.warn("No movies found."),r.style.display="block",void(o.innerHTML='\n        <p class="error-message" style="text-align: center; font-size: 18px; color: red;">\n          No movies found. Please try a different search term.\n        </p>\n      ');const i=await t(),s=a.map((e=>({...e,genre_names:Array.isArray(e.genre_ids)?e.genre_ids.map((e=>i.find((t=>t.id===e))?.name||"Unknown Genre")):[]})));r.style.display="none";const c=s.map(z).join("");o.innerHTML=c}catch(e){console.error("Eroare la afișarea filmelor:",e),r.style.display="block",o.innerHTML='\n      <p class="error-message" style="text-align: center; font-size: 18px; color: red;">\n        Error loading movies. Please try again later.\n      </p>\n    '}}window.addEventListener("resize",(()=>{L.children.length>0&&(Z?P(Z,p):V(p))}));const Y=document.querySelector(".search"),K=document.querySelector(".search-button"),X=document.querySelector(".loader");let Z="";K.addEventListener("click",(function(e){e.preventDefault();const t=Y.value.trim();""!==t&&(Z=t,o(),J(t,1).finally((()=>{X.classList.remove("show")})),Y.value="",o())})),Y.addEventListener("keydown",(function(e){if("Enter"===e.key){e.preventDefault();const t=1,n=Y.value.trim();if(""===n)return;Z=n,o(),J(n,t).finally((()=>{X.classList.remove("show")})),Y.value=""}})),document.addEventListener("DOMContentLoaded",(()=>{o(),V(),R()}));
//# sourceMappingURL=index.e685447d.js.map
